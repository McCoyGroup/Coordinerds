(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     79853,       2280]
NotebookOptionsPosition[     73525,       2192]
NotebookOutlinePosition[     73989,       2210]
CellTagsIndexPosition[     73946,       2207]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Z-Matrix Derivatives", "Section",
 CellChangeTimes->{{3.797003615178837*^9, 
  3.7970036187207127`*^9}},ExpressionUUID->"e8fed0b6-c7ef-4c9a-ad30-\
35bf40135a5c"],

Cell["\<\
We do so much work with Z-matrices and Cartesians that we should really have \
an analytic representation of the Jacobian. So let\[CloseCurlyQuote]s get on \
that. We\[CloseCurlyQuote]ll start by going from Z-matrix to Cartesian. To do \
that we note that we need 3 pieces of info\
\>", "ExpositoryText",
 CellChangeTimes->{{3.797003632485889*^9, 3.797003693494186*^9}, {
  3.797004226838447*^9, 3.797004271994122*^9}, {3.797004338942968*^9, 
  3.797004340374627*^9}},ExpressionUUID->"2d86bed5-1bc4-4815-8079-\
826bb9331c36"],

Cell[CellGroupData[{

Cell[TextData[{
 "The origin ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"\[VeryThinSpace]", "0"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f87d12a1-d4d7-4844-97f9-69f387d1751e"],
 ", can be assumed to be (0, 0, 0) by default"
}], "Subitem",
 CellChangeTimes->{{3.797004274336594*^9, 3.797004297188513*^9}, {
  3.797004344854517*^9, 
  3.7970043574702997`*^9}},ExpressionUUID->"79e20878-28a6-4c5b-ad55-\
56cdfe4ad546"],

Cell[TextData[{
 "The axis system ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["e", "1"], ",", " ", 
     SubscriptBox["e", "2"], ",", " ", 
     SubscriptBox["e", "3"]}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "565f0a6f-71f0-4ce7-b2b3-a2a3c5374280"],
 ", can be assumed to be ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "3"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ce93cfc0-9097-42b9-892a-b128e9bfcaf9"],
 " (well really ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "3"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4c024411-246d-41bc-bcbe-93439f96ce0f"],
 " actually isn\[CloseCurlyQuote]t necessary)"
}], "Subitem",
 CellChangeTimes->{{3.797004274336594*^9, 3.7970043119637527`*^9}, {
  3.797004359078268*^9, 3.797004364271207*^9}, {3.797033938501095*^9, 
  3.797033950509667*^9}},ExpressionUUID->"eb90f171-295b-48a5-b375-\
952193c3bf48"],

Cell["The Z-matrix", "Subitem",
 CellChangeTimes->{{3.797004274336594*^9, 
  3.7970043374625053`*^9}},ExpressionUUID->"68ebe138-f294-45cc-bd38-\
c89365ddc2dd"]
}, Open  ]],

Cell["For every atom, our Z-matrix tells us 6 things", "ExpositoryText",
 CellChangeTimes->{{3.797004409916452*^9, 
  3.79700445116326*^9}},ExpressionUUID->"0738a1ea-ec14-4624-9fa0-\
d301ed8b3ead"],

Cell[CellGroupData[{

Cell[TextData[{
 "What are the reference positions, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"i", "-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7e157cd0-8b98-49af-ad10-942d85f64614"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"i", "-", "2"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7dbcef87-9a44-4c1b-a9d1-ebbae11c2d71"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"i", "-", "3"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "57194b16-47a2-4387-8202-c13d713f2889"]
}], "Subitem",
 CellChangeTimes->{{3.797004454383284*^9, 
  3.797004506614588*^9}},ExpressionUUID->"a00a4682-e77d-498c-9272-\
74cc45470720"],

Cell[TextData[{
 "What are the reference values, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    RowBox[{"i", ",", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e0ab3a3f-99e1-4930-90d6-d5fea219ae20"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    RowBox[{"i", ",", "2"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4803e2c9-6e66-4c6c-b583-b70758465a42"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    RowBox[{"i", ",", "3"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e1b17d03-0519-40e6-be75-fcd0cf86231a"]
}], "Subitem",
 CellChangeTimes->{{3.797003687670658*^9, 3.797003687834305*^9}, 
   3.7970043433206453`*^9, {3.7970045088805113`*^9, 
   3.797004540031261*^9}},ExpressionUUID->"d09e75bb-9717-4228-aedc-\
0e41c4714818"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivation", "Subsection",
 CellChangeTimes->{{3.797012631487504*^9, 
  3.7970126326626043`*^9}},ExpressionUUID->"0c2a502a-41ee-4ae2-834b-\
c45f5d35f103"],

Cell["We define our coordinates recursively as ", "ExpositoryText",
 CellChangeTimes->{{3.7970046040119333`*^9, 3.797004622931522*^9}, 
   3.7970126360307837`*^9},ExpressionUUID->"d69f69e3-8933-4aae-b3c5-\
ecca8fc7072d"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      SubscriptBox["v", "i"], "=", 
      RowBox[{
       SubscriptBox["x", 
        RowBox[{"i", "-", "2"}]], "-", 
       SubscriptBox["x", 
        RowBox[{"i", "-", "1"}]]}]}]},
    {
     RowBox[{
      SubscriptBox["n", "i"], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", 
          RowBox[{"i", "-", "2"}]], "-", 
         SubscriptBox["x", 
          RowBox[{"i", "-", "1"}]]}], ")"}], "\[Cross]", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", 
          RowBox[{"i", "-", "3"}]], "-", 
         SubscriptBox["x", 
          RowBox[{"i", "-", "1"}]]}], ")"}]}]}]},
    {
     RowBox[{
      SubscriptBox["x", "i"], "=", 
      RowBox[{
       SubscriptBox["x", 
        RowBox[{"i", "-", "1"}]], "+", 
       RowBox[{"R", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["z", 
            RowBox[{"i", ",", "3"}]], ",", " ", 
           SubscriptBox["v", "i"]}], ")"}], "\[CenterDot]", "R"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["z", 
            RowBox[{"i", ",", "2"}]], ",", " ", 
           SubscriptBox["n", "i"]}], ")"}], "\[CenterDot]", 
         SubscriptBox["v", "i"]}]}]}]}]}
   }], TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.79700462463871*^9, 3.7970046701486597`*^9}, {
  3.7970047633664627`*^9, 3.797004773438675*^9}, {3.797004810344576*^9, 
  3.7970048275769873`*^9}, {3.797004865918779*^9, 3.79700487511108*^9}, {
  3.797005075830927*^9, 3.797005180204564*^9}, {3.7970052239507*^9, 
  3.7970052277508593`*^9}},ExpressionUUID->"017310d1-4fdc-47de-ac79-\
12c730d6fd9c"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "(", 
    RowBox[{"\[Theta]", ",", "v"}], ")"}], TraditionalForm]],
  CellChangeTimes->{{3.79700462463871*^9, 3.7970046701486597`*^9}},
  ExpressionUUID->"96e0cb6b-807d-47fe-84e7-6bec3b56eee1"],
 " is a rotation of ",
 Cell[BoxData[
  FormBox["\[Theta]", TraditionalForm]], "ExpositoryTextInline",
  FormatType->"TraditionalForm",ExpressionUUID->
  "5d9e94c1-07ee-42c0-9cf9-96ae2d90b001"],
 " radians about axis ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]], "ExpositoryTextInline",
  FormatType->"TraditionalForm",ExpressionUUID->
  "f5e4b76b-16b0-40bf-b066-7f9b002e53ca"],
 ", given by"
}], "ExpositoryText",
 CellChangeTimes->{{3.797004681325973*^9, 3.7970046898463497`*^9}, {
  3.797004789379237*^9, 3.797004806928885*^9}, {3.797004859623328*^9, 
  3.797004860503286*^9}, {3.797004967979988*^9, 3.7970049847886143`*^9}, {
  3.797005111775794*^9, 3.7970051260716476`*^9}, {3.797006449685738*^9, 
  3.797006451309634*^9}, {3.797007141162924*^9, 
  3.797007144976069*^9}},ExpressionUUID->"2839527e-f0ff-4282-b40b-\
cc25cb977383"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"R", "(", 
    RowBox[{"\[Theta]", ",", " ", "v"}], ")"}], "=", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["v", "z"]}], "sin\[Theta]"}], 
        RowBox[{
         SubscriptBox["v", "y"], "sin\[Theta]"}]},
       {
        RowBox[{
         SubscriptBox["v", "z"], "sin\[Theta]"}], 
        RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["v", "x"]}], "sin\[Theta]"}]},
       {
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["v", "y"]}], "sin\[Theta]"}], 
        RowBox[{
         SubscriptBox["v", "x"], "sin\[Theta]"}], 
        RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}]}
      }], ")"}], "+", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SuperscriptBox[
          SubscriptBox["v", "x"], "2"], 
         RowBox[{
          SubscriptBox["v", "x"], 
          SubscriptBox["v", "y"]}], 
         RowBox[{
          SubscriptBox["v", "x"], 
          SubscriptBox["v", "z"]}]},
        {
         RowBox[{
          SubscriptBox["v", "x"], 
          SubscriptBox["v", "y"]}], 
         SuperscriptBox[
          SubscriptBox["v", "y"], "2"], 
         RowBox[{
          SubscriptBox["v", "y"], 
          SubscriptBox["v", "z"]}]},
        {
         RowBox[{
          SubscriptBox["v", "x"], 
          SubscriptBox["v", "z"]}], 
         RowBox[{
          SubscriptBox["v", "y"], 
          SubscriptBox["v", "z"]}], 
         SuperscriptBox[
          SubscriptBox["v", "z"], "2"]}
       }], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}]}], ")"}]}]}]}], 
  TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797006452271269*^9, 3.797006456926179*^9}, {
   3.797006807083499*^9, 3.797007030835747*^9}, 
   3.7970071436358137`*^9},ExpressionUUID->"bb060644-da4c-414c-810c-\
216040d9b6e8"],

Cell["This means we get", "ExpositoryText",
 CellChangeTimes->{{3.797005312035735*^9, 
  3.79700532739487*^9}},ExpressionUUID->"3918ad19-1b01-469d-9c0e-\
cc87182a698c"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"d", "\[VeryThinSpace]", 
     SubscriptBox["x", "i"]}], 
    RowBox[{"d", "\[VeryThinSpace]", "q"}]], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"d", "\[VeryThinSpace]", 
      SubscriptBox["x", 
       RowBox[{"i", "-", "1"}]]}], 
     RowBox[{"d", "\[VeryThinSpace]", "q"}]], "+", 
    RowBox[{
     FractionBox["d", 
      RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"R", "(", 
        RowBox[{
         SubscriptBox["z", 
          RowBox[{"i", ",", "3"}]], ",", " ", 
         SubscriptBox["v", "i"]}], ")"}], "\[CenterDot]", 
       RowBox[{"R", "(", 
        RowBox[{
         SubscriptBox["z", 
          RowBox[{"i", ",", "2"}]], ",", " ", 
         SubscriptBox["n", "i"]}], ")"}], "\[CenterDot]", 
       SubscriptBox["v", "i"]}], ")"}]}]}]}], 
  TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797005328568742*^9, 3.7970053391874037`*^9}, {
  3.7970056040744658`*^9, 
  3.797005627054892*^9}},ExpressionUUID->"85bb843b-1b5e-4099-9dcf-\
549d4e72bc53"],

Cell[TextData[{
 "Assuming ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]], "ExpositoryTextInline",
  FormatType->"TraditionalForm",ExpressionUUID->
  "2ce3d1c2-0352-4210-9c9e-1745a33caf1c"],
 " is the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", ",", " ", "y", ",", " ", 
    RowBox[{"or", " ", "z"}]}], TraditionalForm]], "ExpositoryTextInline",
  FormatType->"TraditionalForm",ExpressionUUID->
  "6b9fbce1-dbc1-4b49-87ee-98ed41e8256f"],
 " axes, this isn\[CloseCurlyQuote]t terrible to get. "
}], "ExpositoryText",
 CellChangeTimes->{
  3.797006034270748*^9},ExpressionUUID->"adcf2ee1-ba31-4bf7-9f8d-\
27f6f8d2e95f"],

Cell["We\[CloseCurlyQuote]ll condense the rotation matrices into a single \
rotation", "ExpositoryText",
 CellChangeTimes->{{3.797005872032094*^9, 3.7970059222780046`*^9}, 
   3.7970059527740917`*^9, 
   3.797006021823085*^9},ExpressionUUID->"bfb1bf87-96f9-404b-b186-\
8f3735793ece"],

Cell[BoxData[
 FormBox[
  RowBox[{"\[CapitalTheta]", "=", 
   RowBox[{
    RowBox[{"R", "(", 
     RowBox[{
      SubscriptBox["z", 
       RowBox[{"i", ",", "3"}]], ",", " ", 
      SubscriptBox["v", "i"]}], ")"}], "\[CenterDot]", 
    RowBox[{"R", "(", 
     RowBox[{
      SubscriptBox["z", 
       RowBox[{"i", ",", "2"}]], ",", " ", 
      SubscriptBox["n", "i"]}], ")"}]}]}], 
  TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797005924434354*^9, 3.797005938710281*^9}, {
  3.7970064098783197`*^9, 
  3.797006430645508*^9}},ExpressionUUID->"e832871c-7817-431b-83b2-\
59cf4a69ccb5"],

Cell["which means that we get", "ExpositoryText",
 CellChangeTimes->{{3.797005947568327*^9, 
  3.797005999849284*^9}},ExpressionUUID->"2ef5af10-748c-4bd3-9c6d-\
68a44195cc5e"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      FractionBox[
       RowBox[{"d", "\[VeryThinSpace]", 
        SubscriptBox["x", "i"]}], 
       RowBox[{"d", "\[VeryThinSpace]", "q"}]], "=", 
      RowBox[{
       FractionBox[
        RowBox[{"d", "\[VeryThinSpace]", 
         SubscriptBox["x", 
          RowBox[{"i", "-", "1"}]]}], 
        RowBox[{"d", "\[VeryThinSpace]", "q"}]], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["d", 
           RowBox[{"d", "\[VeryThinSpace]", "q"}]], "\[CapitalTheta]"}], 
         ")"}], "\[CenterDot]", 
        SubscriptBox["v", "i"]}], "+", 
       RowBox[{
        RowBox[{"\[CapitalTheta]", "\[CenterDot]", 
         FractionBox["d", 
          RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
        SubscriptBox["v", "i"]}]}]}]},
    {
     RowBox[{"=", 
      RowBox[{
       FractionBox[
        RowBox[{"d", "\[VeryThinSpace]", 
         SubscriptBox["x", 
          RowBox[{"i", "-", "1"}]]}], 
        RowBox[{"d", "\[VeryThinSpace]", "q"}]], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["d", 
           RowBox[{"d", "\[VeryThinSpace]", "q"}]], "\[CapitalTheta]"}], 
         ")"}], "\[CenterDot]", 
        SubscriptBox["v", "i"]}], "+", 
       RowBox[{"\[CapitalTheta]", "\[CenterDot]", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"d", "\[VeryThinSpace]", 
            SubscriptBox["x", 
             RowBox[{"i", "-", "2"}]]}], 
           RowBox[{"d", "\[VeryThinSpace]", "q"}]], "-", 
          FractionBox[
           RowBox[{"d", "\[VeryThinSpace]", 
            SubscriptBox["x", 
             RowBox[{"i", "-", "1"}]]}], 
           RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], ")"}]}]}]}]}
   }], TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.7970060047716*^9, 3.797006006586067*^9}, 
   3.797006118096746*^9, {3.79700615126193*^9, 3.797006258099187*^9}, {
   3.797006420978581*^9, 
   3.7970064235932093`*^9}},ExpressionUUID->"b2b75795-feb0-4548-87df-\
fc3698a059fc"],

Cell[TextData[{
 "Then we can note that the product rule for matrices also applies as usual, \
since ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]], "ExpositoryTextInline",
  FormatType->"TraditionalForm",ExpressionUUID->
  "5eb7b614-726d-4a06-9ba2-9a8878121756"],
 " is scalar, so we get"
}], "ExpositoryText",
 CellChangeTimes->{{3.797006264754712*^9, 3.797006334178137*^9}, 
   3.797006391270851*^9},ExpressionUUID->"ca39ba23-89ef-4a25-a48a-\
7a6c2ce35890"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["d", 
     RowBox[{"d", "\[VeryThinSpace]", "q"}]], "\[CapitalTheta]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["d", 
        RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
       RowBox[{"R", "(", 
        RowBox[{
         SubscriptBox["z", 
          RowBox[{"i", ",", "3"}]], ",", " ", 
         SubscriptBox["v", "i"]}], ")"}]}], ")"}], "\[CenterDot]", 
     RowBox[{"R", "(", 
      RowBox[{
       SubscriptBox["z", 
        RowBox[{"i", ",", "2"}]], ",", " ", 
       SubscriptBox["n", "i"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "(", 
       RowBox[{
        SubscriptBox["z", 
         RowBox[{"i", ",", "3"}]], ",", " ", 
        SubscriptBox["v", "i"]}], ")"}], "\[CenterDot]", 
      FractionBox["d", 
       RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
     RowBox[{"R", "(", 
      RowBox[{
       SubscriptBox["z", 
        RowBox[{"i", ",", "2"}]], ",", " ", 
       SubscriptBox["n", "i"]}], ")"}]}]}]}], 
  TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797006298604991*^9, 3.7970063622634773`*^9}, 
   3.797006435344585*^9},ExpressionUUID->"5c24916b-8d48-4b0d-8bd2-\
211e9fa38c3e"],

Cell["and applying this to our general analytic forms we get", \
"ExpositoryText",
 CellChangeTimes->{{3.797007046660262*^9, 3.797007057948276*^9}, {
  3.7970071304343224`*^9, 
  3.797007132826199*^9}},ExpressionUUID->"5ee86288-b33c-49dc-a931-\
5183ae8e155f"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       FractionBox["d", 
        RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
       RowBox[{"R", "(", 
        RowBox[{"\[Theta]", ",", " ", "v"}], ")"}]}], "=", 
      RowBox[{
       RowBox[{
        FractionBox["d", 
         RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
        RowBox[{"(", GridBox[{
           {
            RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}], 
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["v", "z"]}], "sin\[Theta]"}], 
            RowBox[{
             SubscriptBox["v", "y"], "sin\[Theta]"}]},
           {
            RowBox[{
             SubscriptBox["v", "z"], "sin\[Theta]"}], 
            RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}], 
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["v", "x"]}], "sin\[Theta]"}]},
           {
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["v", "y"]}], "sin\[Theta]"}], 
            RowBox[{
             SubscriptBox["v", "x"], "sin\[Theta]"}], 
            RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}]}
          }], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}]}], ")"}], 
        FractionBox["d", 
         RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
        RowBox[{"(", GridBox[{
           {
            SuperscriptBox[
             SubscriptBox["v", "x"], "2"], 
            RowBox[{
             SubscriptBox["v", "x"], 
             SubscriptBox["v", "y"]}], 
            RowBox[{
             SubscriptBox["v", "x"], 
             SubscriptBox["v", "z"]}]},
           {
            RowBox[{
             SubscriptBox["v", "x"], 
             SubscriptBox["v", "y"]}], 
            SuperscriptBox[
             SubscriptBox["v", "y"], "2"], 
            RowBox[{
             SubscriptBox["v", "y"], 
             SubscriptBox["v", "z"]}]},
           {
            RowBox[{
             SubscriptBox["v", "x"], 
             SubscriptBox["v", "z"]}], 
            RowBox[{
             SubscriptBox["v", "y"], 
             SubscriptBox["v", "z"]}], 
            SuperscriptBox[
             SubscriptBox["v", "z"], "2"]}
          }], ")"}]}]}]}]},
    {
     RowBox[{"=", 
      RowBox[{
       RowBox[{
        StyleBox[Cell[
         "", "ExpositoryTextInline",ExpressionUUID->
          "6f7afd8a-873d-4b21-b7c0-4fbb40a7da14"],
         FontSize->12], 
        StyleBox[
         RowBox[{"sin\[Theta]", "\[VeryThinSpace]", "(", GridBox[{
            {"0", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{"d", "\[VeryThinSpace]", 
                SubscriptBox["v", "z"]}], 
               RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["v", "y"]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]},
            {
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["v", "z"]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]], "0", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{"d", "\[VeryThinSpace]", 
                SubscriptBox["v", "x"]}], 
               RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]},
            {
             RowBox[{"-", 
              FractionBox[
               RowBox[{"d", "\[VeryThinSpace]", 
                SubscriptBox["v", "y"]}], 
               RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["v", "x"]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]], "0"}
           }], ")"}],
         FontSize->14]}], 
       StyleBox["+",
        FontSize->12], 
       StyleBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}]}], ")"}], 
         FractionBox["d", 
          RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"2", 
              FractionBox[
               RowBox[{"d", "\[VeryThinSpace]", 
                SubscriptBox["v", "x"]}], 
               RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "x"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
               SubscriptBox["v", "y"]}], "+", 
              RowBox[{
               SubscriptBox["v", "x"], 
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "y"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}], 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "x"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
               SubscriptBox["v", "z"]}], "+", 
              RowBox[{
               SubscriptBox["v", "x"], 
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "z"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]},
            {
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "x"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
               SubscriptBox["v", "y"]}], "+", 
              RowBox[{
               SubscriptBox["v", "x"], 
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "y"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}], 
             RowBox[{"2", 
              FractionBox[
               RowBox[{"d", "\[VeryThinSpace]", 
                SubscriptBox["v", "x"]}], 
               RowBox[{"d", "\[VeryThinSpace]", "y"}]]}], 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "y"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
               SubscriptBox["v", "z"]}], "+", 
              RowBox[{
               SubscriptBox["v", "y"], 
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "z"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]},
            {
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "x"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
               SubscriptBox["v", "z"]}], "+", 
              RowBox[{
               SubscriptBox["v", "x"], 
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "z"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}], 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "y"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
               SubscriptBox["v", "z"]}], "+", 
              RowBox[{
               SubscriptBox["v", "y"], 
               FractionBox[
                RowBox[{"d", "\[VeryThinSpace]", 
                 SubscriptBox["v", "z"]}], 
                RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}], 
             RowBox[{"2", 
              FractionBox[
               RowBox[{"d", "\[VeryThinSpace]", 
                SubscriptBox["v", "x"]}], 
               RowBox[{"d", "\[VeryThinSpace]", "z"}]]}]}
           }], ")"}]}],
        FontSize->14]}]}]}
   }], TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797007061225423*^9, 3.7970071251466637`*^9}, {
  3.797007157381912*^9, 
  3.797007382879064*^9}},ExpressionUUID->"780ca64f-7412-4115-ac4e-\
3fabdc685536"],

Cell[TextData[{
 "then we have a relation for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "i"], TraditionalForm]],
  CellChangeTimes->{{3.7970086146735773`*^9, 3.797008656122264*^9}, {
   3.797008701191381*^9, 3.7970087039655647`*^9}},ExpressionUUID->
  "0ae539ad-a5a4-4f2b-9075-409dba316db2"],
 " as"
}], "ExpositoryText",
 CellChangeTimes->{{3.797008570079899*^9, 3.79700861068729*^9}, {
  3.797008651254187*^9, 3.79700865222999*^9}, {3.797008716020824*^9, 
  3.797008726724739*^9}},ExpressionUUID->"e082c27d-1380-4fe6-9867-\
e6356a051271"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"d", "\[VeryThinSpace]", 
     SubscriptBox["v", "i"]}], 
    RowBox[{"d", "\[VeryThinSpace]", "q"}]], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"d", "\[VeryThinSpace]", 
      SubscriptBox["x", 
       RowBox[{"i", "-", "2"}]]}], 
     RowBox[{"d", "\[VeryThinSpace]", "q"}]], "-", 
    FractionBox[
     RowBox[{"d", "\[VeryThinSpace]", 
      SubscriptBox["x", 
       RowBox[{"i", "-", "2"}]]}], 
     RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}], 
  TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.7970086146735773`*^9, 3.797008656122264*^9}, {
  3.797008701191381*^9, 
  3.7970087039655647`*^9}},ExpressionUUID->"bdcabde6-fad3-4c74-9a81-\
d35e09af030b"],

Cell[TextData[{
 "which is pretty easy to build out, but the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "i"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4889b8df-f0ba-48b2-b93b-146903a35c6c"],
 " term is much nastier"
}], "Text",
 CellChangeTimes->{{3.797008657742235*^9, 3.797008670477775*^9}, {
  3.7970087090210047`*^9, 
  3.797008714229066*^9}},ExpressionUUID->"1d0d88a4-8be6-4a3c-868e-\
3a6c7a256791"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"d", "\[VeryThinSpace]", 
     SubscriptBox["n", "i"]}], 
    RowBox[{"d", "\[VeryThinSpace]", "q"}]], "=", 
   RowBox[{
    FractionBox["d", 
     RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", 
         RowBox[{"i", "-", "2"}]], "-", 
        SubscriptBox["x", 
         RowBox[{"i", "-", "1"}]]}], ")"}], "\[Cross]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", 
         RowBox[{"i", "-", "3"}]], "-", 
        SubscriptBox["x", 
         RowBox[{"i", "-", "1"}]]}], ")"}]}], ")"}]}]}], 
  TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.7970086755375338`*^9, 
  3.797008699405652*^9}},ExpressionUUID->"f2d8d398-826e-49db-9651-\
88b4628fcfff"],

Cell["\<\
and then we\[CloseCurlyQuote]ll want to look at the expression for a \
cross-product\
\>", "ExpositoryText",
 CellChangeTimes->{{3.7970091170796223`*^9, 
  3.797009156717718*^9}},ExpressionUUID->"289f73fd-c855-4e7f-9651-\
93d24e4e1cff"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["v", "1"], "\[Times]", 
    SubscriptBox["v", 
     RowBox[{"\[VeryThinSpace]", "2"}]]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubscriptBox["x", 
          RowBox[{"\[VeryThinSpace]", "1"}]], 
         SubscriptBox["y", 
          RowBox[{"\[VeryThinSpace]", "1"}]], 
         SubscriptBox["z", 
          RowBox[{"\[VeryThinSpace]", "1"}]]}
       }], ")"}], "\[Times]", 
     RowBox[{"(", GridBox[{
        {
         SubscriptBox["x", 
          RowBox[{"\[VeryThinSpace]", "2"}]], 
         SubscriptBox["y", 
          RowBox[{"\[VeryThinSpace]", "2"}]], 
         SubscriptBox["z", 
          RowBox[{"\[VeryThinSpace]", "2"}]]}
       }], ")"}]}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["y", "2"]}], 
          SubscriptBox["z", "1"]}], "+", 
         RowBox[{
          SubscriptBox["y", "1"], 
          SubscriptBox["z", "2"]}]}], 
        RowBox[{
         RowBox[{
          SubscriptBox["x", 
           RowBox[{"\[VeryThinSpace]", "2"}]], " ", 
          SubscriptBox["z", "1"]}], "-", "\[VeryThinSpace]", 
         RowBox[{
          SubscriptBox["x", "1"], 
          SubscriptBox["z", 
           RowBox[{"\[VeryThinSpace]", "2"}]]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["x", 
            RowBox[{"\[VeryThinSpace]", "2"}]]}], 
          SubscriptBox["y", "1"]}], "+", 
         RowBox[{
          SubscriptBox["x", "1"], 
          SubscriptBox["y", "2"]}]}]}
      }], ")"}]}]}], TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797009202900559*^9, 3.7970092566501503`*^9}, {
  3.797009596772036*^9, 3.7970096507304487`*^9}, {3.7970098364561777`*^9, 
  3.797009886030518*^9}, {3.7970110554404917`*^9, 
  3.797011063775773*^9}},ExpressionUUID->"f70abed5-56a6-4516-8668-\
c80459e4d4f6"],

Cell["then we can get the derivative of this", "ExpositoryText",
 CellChangeTimes->{{3.79701049766539*^9, 3.797010500049172*^9}, {
  3.797010721395656*^9, 
  3.79701072461979*^9}},ExpressionUUID->"e21ff5cc-9949-4e5a-a512-\
6883022f0124"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      FractionBox[
       RowBox[{"d", "\[VeryThinSpace]", "(", 
        RowBox[{
         SubscriptBox["v", "1"], "\[Times]", 
         SubscriptBox["v", 
          RowBox[{"\[VeryThinSpace]", "2"}]]}], ")"}], 
       RowBox[{"d", "\[VeryThinSpace]", "q"}]], "=", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           FractionBox["d", 
            RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SubscriptBox["y", 
                RowBox[{"\[VeryThinSpace]", "2"}]]}], 
              SubscriptBox["z", "1"]}], "+", 
             RowBox[{
              SubscriptBox["y", "1"], 
              SubscriptBox[
               RowBox[{"z", "\[VeryThinSpace]"}], "2"]}]}], ")"}]}], 
          RowBox[{
           FractionBox["d", 
            RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", 
               RowBox[{"\[VeryThinSpace]", "2"}]], " ", 
              SubscriptBox["z", "1"]}], "-", "\[VeryThinSpace]", 
             RowBox[{
              SubscriptBox["x", 
               RowBox[{"\[VeryThinSpace]", "1"}]], 
              SubscriptBox["z", 
               RowBox[{"\[VeryThinSpace]", "2"}]]}]}], ")"}]}], 
          RowBox[{
           FractionBox["d", 
            RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SubscriptBox[
                RowBox[{"x", "\[VeryThinSpace]"}], 
                RowBox[{"\[VeryThinSpace]", "2"}]]}], 
              SubscriptBox["y", 
               RowBox[{"\[VeryThinSpace]", "1"}]]}], "+", 
             RowBox[{
              SubscriptBox[
               RowBox[{"x", "\[VeryThinSpace]"}], "1"], 
              SubscriptBox["y", 
               RowBox[{"\[VeryThinSpace]", "2"}]]}]}], ")"}]}]}
        }], ")"}]}]},
    {
     RowBox[{"=", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["d", 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
            SubscriptBox["y", 
             RowBox[{"\[VeryThinSpace]", "2"}]], 
            SubscriptBox["z", "1"]}], "+", 
           RowBox[{
            FractionBox["d", 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
            SubscriptBox["y", "1"], 
            SubscriptBox[
             RowBox[{"z", "\[VeryThinSpace]"}], "2"]}]}]},
         {
          RowBox[{
           RowBox[{
            FractionBox["d", 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
            SubscriptBox["x", 
             RowBox[{"\[VeryThinSpace]", "2"}]], " ", 
            SubscriptBox["z", "1"]}], "-", "\[VeryThinSpace]", 
           RowBox[{
            FractionBox["d", 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
            SubscriptBox["x", 
             RowBox[{"\[VeryThinSpace]", "1"}]], 
            SubscriptBox["z", 
             RowBox[{"\[VeryThinSpace]", "2"}]]}]}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["d", 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
            SubscriptBox[
             RowBox[{"x", "\[VeryThinSpace]"}], 
             RowBox[{"\[VeryThinSpace]", "2"}]], 
            SubscriptBox["y", 
             RowBox[{"\[VeryThinSpace]", "1"}]]}], "+", 
           RowBox[{
            FractionBox["d", 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
            SubscriptBox[
             RowBox[{"x", "\[VeryThinSpace]"}], "1"], 
            SubscriptBox["y", 
             RowBox[{"\[VeryThinSpace]", "2"}]]}]}]}
        }], ")"}]}]},
    {
     RowBox[{"=", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["y", 
                RowBox[{"\[VeryThinSpace]", "2"}]]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
            SubscriptBox["z", "1"]}], "-", 
           RowBox[{
            SubscriptBox["y", 
             RowBox[{"\[VeryThinSpace]", "2"}]], 
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox["z", "1"]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox["y", "1"]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
            SubscriptBox[
             RowBox[{"z", "\[VeryThinSpace]"}], "2"]}], "+", 
           RowBox[{
            SubscriptBox["y", "1"], 
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox[
               RowBox[{"z", "\[VeryThinSpace]"}], "2"]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]},
         {
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox["x", 
               RowBox[{"\[VeryThinSpace]", "2"}]]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
            SubscriptBox["z", "1"]}], "+", 
           RowBox[{
            SubscriptBox["x", 
             RowBox[{"\[VeryThinSpace]", "2"}]], " ", 
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox["z", "1"]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], "-", 
           "\[VeryThinSpace]", 
           RowBox[{
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox["x", 
               RowBox[{"\[VeryThinSpace]", "1"}]]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
            SubscriptBox["z", 
             RowBox[{"\[VeryThinSpace]", "2"}]]}], "-", 
           RowBox[{
            SubscriptBox["x", 
             RowBox[{"\[VeryThinSpace]", "1"}]], 
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox["z", 
               RowBox[{"\[VeryThinSpace]", "2"}]]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox[
                RowBox[{"x", "\[VeryThinSpace]"}], 
                RowBox[{"\[VeryThinSpace]", "2"}]]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
            SubscriptBox["y", 
             RowBox[{"\[VeryThinSpace]", "1"}]]}], "-", 
           RowBox[{
            SubscriptBox[
             RowBox[{"x", "\[VeryThinSpace]"}], 
             RowBox[{"\[VeryThinSpace]", "2"}]], 
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox["y", 
               RowBox[{"\[VeryThinSpace]", "1"}]]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox[
               RowBox[{"x", "\[VeryThinSpace]"}], "1"]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
            SubscriptBox["y", 
             RowBox[{"\[VeryThinSpace]", "2"}]]}], "+", 
           RowBox[{
            SubscriptBox[
             RowBox[{"x", "\[VeryThinSpace]"}], "1"], 
            FractionBox[
             RowBox[{"d", "\[VeryThinSpace]", 
              SubscriptBox["y", 
               RowBox[{"\[VeryThinSpace]", "2"}]]}], 
             RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]}
        }], ")"}]}]},
    {
     RowBox[{"=", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["y", 
               RowBox[{"\[VeryThinSpace]", "2"}]]}], 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["z", "1"]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["y", "1"]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
             SubscriptBox[
              RowBox[{"z", "\[VeryThinSpace]"}], "2"]}]}]},
          {
           RowBox[{
            RowBox[{
             SubscriptBox["x", 
              RowBox[{"\[VeryThinSpace]", "2"}]], " ", 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["z", "1"]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], "-", 
            "\[VeryThinSpace]", 
            RowBox[{
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["x", 
                RowBox[{"\[VeryThinSpace]", "1"}]]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
             SubscriptBox["z", 
              RowBox[{"\[VeryThinSpace]", "2"}]]}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SubscriptBox[
               RowBox[{"x", "\[VeryThinSpace]"}], 
               RowBox[{"\[VeryThinSpace]", "2"}]]}], 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["y", 
                RowBox[{"\[VeryThinSpace]", "1"}]]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox[
                RowBox[{"x", "\[VeryThinSpace]"}], "1"]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
             SubscriptBox["y", 
              RowBox[{"\[VeryThinSpace]", "2"}]]}]}]}
         }], ")"}], "+", 
       RowBox[{"(", GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"d", "\[VeryThinSpace]", 
                SubscriptBox["y", 
                 RowBox[{"\[VeryThinSpace]", "2"}]]}], 
               RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
             SubscriptBox["z", "1"]}], "+", 
            RowBox[{
             SubscriptBox["y", "1"], 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox[
                RowBox[{"z", "\[VeryThinSpace]"}], "2"]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]},
          {
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["x", 
                RowBox[{"\[VeryThinSpace]", "2"}]]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
             SubscriptBox["z", "1"]}], "-", 
            RowBox[{
             SubscriptBox["x", 
              RowBox[{"\[VeryThinSpace]", "1"}]], 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["z", 
                RowBox[{"\[VeryThinSpace]", "2"}]]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]},
          {
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"d", "\[VeryThinSpace]", 
                SubscriptBox[
                 RowBox[{"x", "\[VeryThinSpace]"}], 
                 RowBox[{"\[VeryThinSpace]", "2"}]]}], 
               RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
             SubscriptBox["y", 
              RowBox[{"\[VeryThinSpace]", "1"}]]}], "+", 
            RowBox[{
             SubscriptBox[
              RowBox[{"x", "\[VeryThinSpace]"}], "1"], 
             FractionBox[
              RowBox[{"d", "\[VeryThinSpace]", 
               SubscriptBox["y", 
                RowBox[{"\[VeryThinSpace]", "2"}]]}], 
              RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]}
         }], ")"}]}]}]},
    {
     RowBox[{"=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"d", "\[VeryThinSpace]", 
          SubscriptBox["v", "1"]}], 
         RowBox[{"d", "\[VeryThinSpace]", "q"}]], "\[Times]", 
        SubscriptBox["v", 
         RowBox[{"\[VeryThinSpace]", "2"}]]}], "+", 
       RowBox[{
        SubscriptBox["v", "1"], "\[Times]", 
        FractionBox[
         RowBox[{"d", "\[VeryThinSpace]", 
          SubscriptBox["v", 
           RowBox[{"\[VeryThinSpace]", "2"}]]}], 
         RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]}]}
   }], TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797010501402677*^9, 3.797010571639564*^9}, {
  3.797010609795792*^9, 3.7970106104229393`*^9}, {3.79701066059197*^9, 
  3.7970107164604053`*^9}, {3.7970107845622587`*^9, 3.7970108120689173`*^9}, {
  3.797010856875752*^9, 3.79701103173623*^9}, {3.797011067832995*^9, 
  3.797011071551907*^9}, {3.797011551831027*^9, 3.797011553137105*^9}, {
  3.79701322193707*^9, 3.79701324768744*^9}, {3.797031171276927*^9, 
  3.797031358877705*^9}, {3.797031391256459*^9, 3.797031490823814*^9}, {
  3.7970320025650663`*^9, 
  3.797032004914976*^9}},ExpressionUUID->"dc3db01e-6321-4fa7-b405-\
bab5d5889b1c"],

Cell[TextData[{
 "and so for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "i"], TraditionalForm]], "ExpositoryTextInline",
  FormatType->"TraditionalForm",ExpressionUUID->
  "0efba297-f454-47a6-a6f5-07ac605793e9"],
 " we have"
}], "ExpositoryText",
 CellChangeTimes->{{3.797011557375819*^9, 3.797011572231682*^9}, {
  3.797011858967327*^9, 3.797011863518182*^9}, {3.797012671527371*^9, 
  3.797012672182061*^9}, {3.7970315657758083`*^9, 
  3.7970315663031397`*^9}},ExpressionUUID->"ab325d18-0b9d-4cac-b66c-\
c5463dee3f2a"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      FractionBox[
       RowBox[{"d", "\[VeryThinSpace]", 
        SubscriptBox["n", "i"]}], 
       RowBox[{"d", "\[VeryThinSpace]", "q"}]], "=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"d", "\[VeryThinSpace]"}], 
         RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", 
            RowBox[{"i", "-", "2"}]], "-", 
           SubscriptBox["x", 
            RowBox[{"i", "-", "1"}]]}], ")"}], "\[Cross]", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", 
            RowBox[{"i", "-", "3"}]], "-", 
           SubscriptBox["x", 
            RowBox[{"i", "-", "1"}]]}], ")"}]}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", 
            RowBox[{"i", "-", "2"}]], "-", 
           SubscriptBox["x", 
            RowBox[{"i", "-", "1"}]]}], ")"}], "\[Cross]", 
         FractionBox[
          RowBox[{"d", "\[VeryThinSpace]"}], 
          RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", 
           RowBox[{"i", "-", "3"}]], "-", 
          SubscriptBox["x", 
           RowBox[{"i", "-", "1"}]]}], ")"}]}]}]}]},
    {
     RowBox[{"=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"d", "\[VeryThinSpace]", 
            SubscriptBox["x", 
             RowBox[{"i", "-", "2"}]]}], 
           RowBox[{"d", "\[VeryThinSpace]", "q"}]], "-", 
          FractionBox[
           RowBox[{"d", "\[VeryThinSpace]", 
            SubscriptBox["x", 
             RowBox[{"i", "-", "1"}]]}], 
           RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], ")"}], "\[Cross]", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", 
           RowBox[{"i", "-", "3"}]], "-", 
          SubscriptBox["x", 
           RowBox[{"i", "-", "1"}]]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", 
           RowBox[{"i", "-", "2"}]], "-", 
          SubscriptBox["x", 
           RowBox[{"i", "-", "1"}]]}], ")"}], "\[Times]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"d", "\[VeryThinSpace]"}], 
            RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
           SubscriptBox["x", 
            RowBox[{"i", "-", "3"}]]}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{"d", "\[VeryThinSpace]"}], 
            RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
           SubscriptBox["x", 
            RowBox[{"i", "-", "1"}]]}]}], ")"}]}]}]}]}
   }], TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797011697690041*^9, 3.797011979077524*^9}, {
  3.797031570469636*^9, 3.7970315945195*^9}, {3.7970316345933313`*^9, 
  3.797031728513098*^9}},ExpressionUUID->"973f7311-0276-48d2-bcd8-\
55df61794737"],

Cell["\<\
so now we have all of our components, and can nicely write out\
\>", "ExpositoryText",
 CellChangeTimes->{{3.797012614582583*^9, 3.797012621238851*^9}, {
  3.797012673285611*^9, 3.797012675549781*^9}, {3.797012817140313*^9, 
  3.797012826579611*^9}},ExpressionUUID->"520e2d13-9ac0-40d3-9c68-\
ad1a6241de16"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      FractionBox[
       RowBox[{"d", "\[VeryThinSpace]", 
        SubscriptBox["x", "i"]}], 
       RowBox[{"d", "\[VeryThinSpace]", "q"}]], "=", 
      RowBox[{
       FractionBox[
        RowBox[{"d", "\[VeryThinSpace]"}], 
        RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", 
          RowBox[{"i", "-", "1"}]], "+", 
         RowBox[{
          SubscriptBox["z", 
           RowBox[{"i", ",", "1"}]], 
          RowBox[{
           RowBox[{"R", "(", 
            RowBox[{
             SubscriptBox["z", 
              RowBox[{"i", ",", "3"}]], ",", " ", 
             SubscriptBox["v", "i"]}], ")"}], "\[CenterDot]", 
           RowBox[{"R", "(", 
            RowBox[{
             SubscriptBox["z", 
              RowBox[{"i", ",", "2"}]], ",", " ", 
             SubscriptBox["n", "i"]}], ")"}], "\[CenterDot]", 
           SubscriptBox["v", "i"]}]}]}], ")"}]}]}]},
    {
     RowBox[{"=", 
      StyleBox[
       RowBox[{
        FractionBox[
         RowBox[{"d", "\[VeryThinSpace]", 
          SubscriptBox["x", 
           RowBox[{"i", "-", "1"}]]}], 
         RowBox[{"d", "\[VeryThinSpace]", "q"}]], "+", 
        RowBox[{
         SubscriptBox["z", 
          RowBox[{"i", ",", "1"}]], 
         FractionBox["d", 
          RowBox[{"d", "\[VeryThinSpace]", "q"}]], 
         RowBox[{
          RowBox[{"R", "(", 
           RowBox[{
            SubscriptBox["z", 
             RowBox[{"i", ",", "3"}]], ",", " ", 
            SubscriptBox["v", "i"]}], ")"}], "\[CenterDot]", 
          RowBox[{"R", "(", 
           RowBox[{
            SubscriptBox["z", 
             RowBox[{"i", ",", "2"}]], ",", " ", 
            SubscriptBox["n", "i"]}], ")"}], "\[CenterDot]", 
          SubscriptBox["v", "i"]}]}], "+", 
        RowBox[{
         SubscriptBox["z", 
          RowBox[{"i", ",", "1"}]], 
         RowBox[{
          RowBox[{"R", "(", 
           RowBox[{
            SubscriptBox["z", 
             RowBox[{"i", ",", "3"}]], ",", " ", 
            SubscriptBox["v", "i"]}], ")"}], "\[CenterDot]", 
          FractionBox["d", 
           RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
         RowBox[{
          RowBox[{"R", "(", 
           RowBox[{
            SubscriptBox["z", 
             RowBox[{"i", ",", "2"}]], ",", " ", 
            SubscriptBox["n", "i"]}], ")"}], "\[CenterDot]", 
          SubscriptBox["v", "i"]}]}], "+", 
        RowBox[{
         SubscriptBox["z", 
          RowBox[{"i", ",", "1"}]], 
         RowBox[{
          RowBox[{"R", "(", 
           RowBox[{
            SubscriptBox["z", 
             RowBox[{"i", ",", "3"}]], ",", " ", 
            SubscriptBox["v", "i"]}], ")"}], "\[CenterDot]", 
          RowBox[{"R", "(", 
           RowBox[{
            SubscriptBox["z", 
             RowBox[{"i", ",", "2"}]], ",", " ", 
            SubscriptBox["n", "i"]}], ")"}], "\[CenterDot]", 
          FractionBox["d", 
           RowBox[{"d", "\[VeryThinSpace]", "q"}]]}], 
         SubscriptBox["v", "i"]}]}],
       FontSize->14]}]}
   }], TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797012775846491*^9, 3.7970129281340723`*^9}, {
  3.797012979478095*^9, 3.797013001955587*^9}, {3.797034176205064*^9, 
  3.7970342468249683`*^9}},ExpressionUUID->"4d4d03e2-8d54-40ad-ab96-\
bc94178ddc4a"],

Cell["\<\
and we now know how to write out every one of these components\
\>", "ExpositoryText",
 CellChangeTimes->{{3.797012948694805*^9, 3.7970129619106073`*^9}, {
  3.797031742953979*^9, 
  3.797031743457387*^9}},ExpressionUUID->"8e291441-8d4c-4027-83c2-\
113d86d61d82"],

Cell["Finally, we have a few special cases to consider", "ExpositoryText",
 CellChangeTimes->{{3.7970337677845592`*^9, 
  3.797033796815774*^9}},ExpressionUUID->"8ae3412a-46ef-4025-a63f-\
9a286bc16ae2"],

Cell[CellGroupData[{

Cell[TextData[{
 "For ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"\[VeryThinSpace]", "0"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2efce486-a802-4b9e-8c3b-469a37c083f0"],
 ", unless we have a moving system the derivative is always 0 since this is \
an input value"
}], "Subitem",
 CellChangeTimes->{{3.79703380297547*^9, 3.79703385051749*^9}, {
  3.797033904694296*^9, 
  3.7970339046944647`*^9}},ExpressionUUID->"69ba4066-166a-4277-866a-\
3aabb3872767"],

Cell[TextData[{
 "For ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "1"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b623d8da-a8a4-4441-9993-49855fdd6088"],
 ", we set ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "1"], "=", 
    SubscriptBox["e", "1"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "970236ee-7c04-4b10-87cb-c46acaa39994"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", 
     RowBox[{"1", ",", "2"}]], "=", 
    RowBox[{
     SubscriptBox["z", 
      RowBox[{"1", ",", "3"}]], "=", "0"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "eee03b74-7fd7-4750-9c70-fb2d04764513"]
}], "Subitem",
 CellChangeTimes->{{3.79703380297547*^9, 3.79703385051749*^9}, {
  3.7970339079983683`*^9, 3.797033933733801*^9}, {3.797033979776353*^9, 
  3.797033993287785*^9}},ExpressionUUID->"2f33073c-3178-4180-9ca8-\
7061814dfdaa"],

Cell[TextData[{
 "For ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5196bee4-c56e-4e4b-be10-d7e18a8505c1"],
 ", we set ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "2"], "=", 
    SubscriptBox["e", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ddaa75af-6026-4ff4-a0cc-e78d2eea8fd4"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", 
     RowBox[{"2", ",", "3"}]], "=", "0"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ce832af9-70af-4c85-8e62-5ffebb20d811"]
}], "Subitem",
 CellChangeTimes->{{3.79703380297547*^9, 3.79703385051749*^9}, {
  3.7970339079983683`*^9, 3.797033933733801*^9}, {3.797033979776353*^9, 
  3.797034032298503*^9}},ExpressionUUID->"da9c34ce-3d67-4114-b086-\
5fffee5d4038"]
}, Open  ]],

Cell["With that in mind, we get", "ExpositoryText",
 CellChangeTimes->{{3.797034050742378*^9, 
  3.797034054942729*^9}},ExpressionUUID->"8d40a7a5-2e7b-4dc0-a34a-\
3d612216a9d4"],

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      FractionBox[
       RowBox[{"d", "\[VeryThinSpace]", 
        SubscriptBox["x", 
         RowBox[{"\[VeryThinSpace]", "1"}]]}], 
       RowBox[{"d", "\[VeryThinSpace]", "q"}]], "=", 
      RowBox[{
       FractionBox[
        RowBox[{"d", "\[VeryThinSpace]", 
         SubscriptBox["x", 
          RowBox[{"\[VeryThinSpace]", "0"}]]}], 
        RowBox[{"d", "\[VeryThinSpace]", "q"}]], "+", 
       RowBox[{
        SubscriptBox["z", 
         RowBox[{"1", ",", "1"}]], 
        FractionBox[
         RowBox[{"d", "\[VeryThinSpace]", 
          SubscriptBox["e", "1"]}], 
         RowBox[{"d", "\[VeryThinSpace]", "q"}]]}]}]}]},
    {
     RowBox[{
      FractionBox[
       RowBox[{"d", "\[VeryThinSpace]", 
        SubscriptBox["x", 
         RowBox[{"\[VeryThinSpace]", "2"}]]}], 
       RowBox[{"d", "\[VeryThinSpace]", "q"}]], "=", 
      RowBox[{
       FractionBox[
        RowBox[{"d", "\[VeryThinSpace]", 
         SubscriptBox["x", 
          RowBox[{"\[VeryThinSpace]", "1"}]]}], 
        RowBox[{"d", "\[VeryThinSpace]", "q"}]], "+"}]}]}
   }], TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.7970340568322573`*^9, 3.797034083094255*^9}, 
   3.797034116725999*^9, {3.79703415688163*^9, 3.7970341858619537`*^9}, {
   3.797034262433793*^9, 
   3.797034286782597*^9}},ExpressionUUID->"e0c4e874-d602-4bd3-851b-\
f1664b8f8636"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Subsection",
 CellChangeTimes->{{3.797033722934072*^9, 
  3.797033725179187*^9}},ExpressionUUID->"eb827615-2e3d-4727-9015-\
ebf6678e9253"],

Cell["\<\
def dni(xi1, xi2, xi3, dxi1, dxi2, dxi3):
    return np.cross(dxi2-dxi1, xi3-xi1)+np.cross(xi2-xi1, dxi3-dxi1)
    
def dvi(dxi1, dxi2):
    return dxi2 - dxi1

def R(a, v):
    x = v[0]
    y = v[1]
    z = v[2]
    ident_comp = np.cos(a)*np.eye(3)
    sin_comp = np.sin(a)*np.array(
        [
          [ 0,  -z,   y],
          [ z,   0,  -x],
          [-y,   x,   0]
        ]
      )
    cos_comp = (1 - np.cos(a))*np.array(
        [
          [ x**2,  x*y,  x*z],
          [  x*y, y**2,  y*z],
          [  x*z,  y*z, z**2]
        ]
      )
   return ident_comp + sin_comp + cos_comp

def dR(a, v, dv):
    x = v[0]; dx = dv[0]
    y = v[1]; dy = dv[1]
    z = v[2]; dz = dv[2]
    sin_comp = np.sin(a)*np.array(
        [
          [     0, -dz,  dy],
          [ dz,      0, -dx],
          [-dy,     dx,   0]
        ]
      )
    cos_comp = (1 - np.cos(a))*np.array(
        [
          [      2*dx,   dx*y+x*dy,  dx*z+x*dz],
          [ dx*y+x*dy,        2*dy,  dy*z+y*dz],
          [ dx*z+x*dz,   dy*z+y*dz,       2*dz]
        ]
      )
    return sin_comp + cos_comp\
\>", "ExpositoryMath",
 PageWidth->Infinity,
 CellChangeTimes->{{3.796650470428638*^9, 3.7966506461220903`*^9}, 
   3.7970310638597813`*^9, {3.7970311191049128`*^9, 3.79703112526225*^9}, {
   3.797031625899726*^9, 3.7970316302651854`*^9}, {3.797031745145034*^9, 
   3.7970318240806017`*^9}, {3.79703186711281*^9, 3.7970319546786346`*^9}, {
   3.797032021285894*^9, 3.797032026245781*^9}, {3.7970334435362463`*^9, 
   3.7970337436508417`*^9}, {3.7970343715436*^9, 3.797034372727626*^9}, {
   3.797034407408573*^9, 3.79703446909503*^9}, {3.7970345811871634`*^9, 
   3.797034727224228*^9}, {3.7970348941106586`*^9, 3.7970349988175077`*^9}, {
   3.797035072323464*^9, 3.7970351250883102`*^9}, {3.797035158986588*^9, 
   3.797035246268417*^9}, {3.797035564036846*^9, 3.797035569589625*^9}},
 FontFamily->"Menlo",
 FontSize->12,ExpressionUUID->"7141d0d4-0249-41fe-a05d-01f8d38bfcdc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Higher Derivatives", "Subsection",
 CellChangeTimes->{{3.79703563153759*^9, 
  3.797035635385233*^9}},ExpressionUUID->"2fa6de8d-58f8-417b-a789-\
48b885615aea"],

Cell["\<\
I\[CloseCurlyQuote]m not gonna work out expressions for higher derivatives, \
because they\[CloseCurlyQuote]ll become super annoying, but I note that the \
way forward is probably to recast the rotations in terms of the Rodrigues \
Rotation Formula\
\>", "ExpositoryText",
 CellChangeTimes->{{3.797035637512948*^9, 3.7970356652885513`*^9}, {
  3.7970358622931013`*^9, 
  3.7970358869957123`*^9}},ExpressionUUID->"37290334-3847-40c4-aa6c-\
ded8636afa84"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"R", "(", 
     RowBox[{"a", ",", " ", "k"}], ")"}], ".", "v"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]", " ", "v"}], "  ", "+", " ", 
    RowBox[{"sin\[Theta]", " ", 
     RowBox[{"(", 
      RowBox[{"k", "\[VeryThinSpace]", "\[Times]", "v"}], ")"}]}], " ", "+", 
    " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"k", "\[CenterDot]", "v"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "cos\[Theta]"}], ")"}], "k"}]}]}], 
  TraditionalForm]], "ExpositoryMathCentered",
 CellChangeTimes->{{3.797035881499668*^9, 
  3.797036044944414*^9}},ExpressionUUID->"199c75d8-4ecc-4fbf-8ea2-\
9d9d12d0d2a7"],

Cell["\<\
because Mathematica can differentiate this symbolically without too much work \
as\
\>", "ExpositoryText",
 CellChangeTimes->{{3.797036051221521*^9, 
  3.7970360699495707`*^9}},ExpressionUUID->"0ac1be16-10af-4ac4-8ba0-\
5e16742a632d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rodRot", "[", "vars__", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[FormalTheta]", "]"}], "*", 
     RowBox[{"\[FormalV]", "[", "vars", "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Sin", "[", "\[FormalTheta]", "]"}], "*", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"\[FormalK]", "[", "vars", "]"}], ",", " ", 
       RowBox[{"\[FormalV]", "[", "vars", "]"}]}], "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"\[FormalK]", "[", "vars", "]"}], ",", " ", 
       RowBox[{"\[FormalV]", "[", "vars", "]"}]}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Cos", "[", "\[FormalTheta]", "]"}]}], ")"}], "*", 
     RowBox[{"\[FormalK]", "[", "vars", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"rodRot", "[", "q", "]"}], ",", " ", "q"}], "]"}], "//", 
  "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"rodRot", "[", "q", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"q", ",", " ", "2"}], "}"}]}], "]"}], "//", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.79703607138951*^9, 3.797036292188691*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"1d69062d-4b01-436b-9dec-3722b92110e1"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"cos", "(", "\[FormalTheta]", ")"}]}], ")"}], " ", 
    RowBox[{"\[FormalK]", "(", "q", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", "\[Prime]",
         MultilineFunction->None], "(", "q", ")"}], ".", 
       RowBox[{"\[FormalV]", "(", "q", ")"}]}], "+", 
      RowBox[{
       RowBox[{"\[FormalK]", "(", "q", ")"}], ".", 
       RowBox[{
        SuperscriptBox["\[FormalV]", "\[Prime]",
         MultilineFunction->None], "(", "q", ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"sin", "(", "\[FormalTheta]", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", "\[Prime]",
         MultilineFunction->None], "(", "q", ")"}], "\[Cross]", 
       RowBox[{"\[FormalV]", "(", "q", ")"}]}], "+", 
      RowBox[{
       RowBox[{"\[FormalK]", "(", "q", ")"}], "\[Cross]", 
       RowBox[{
        SuperscriptBox["\[FormalV]", "\[Prime]",
         MultilineFunction->None], "(", "q", ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"cos", "(", "\[FormalTheta]", ")"}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[FormalK]", "\[Prime]",
      MultilineFunction->None], "(", "q", ")"}], " ", 
    RowBox[{
     RowBox[{"\[FormalK]", "(", "q", ")"}], ".", 
     RowBox[{"\[FormalV]", "(", "q", ")"}]}]}], "+", 
   RowBox[{
    RowBox[{"cos", "(", "\[FormalTheta]", ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[FormalV]", "\[Prime]",
      MultilineFunction->None], "(", "q", ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.797036123979212*^9, 3.797036153346146*^9}, 
   3.797036200732106*^9, {3.7970362392353153`*^9, 3.797036247106689*^9}, {
   3.7970362774364643`*^9, 3.7970362925879183`*^9}},
 CellLabel->
  "Out[182]//TraditionalForm=",ExpressionUUID->"dea9f4bc-6832-4a96-b0d4-\
a24e3c83abe0"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"cos", "(", "\[FormalTheta]", ")"}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[FormalK]", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "q", ")"}], " ", 
    RowBox[{
     RowBox[{"\[FormalK]", "(", "q", ")"}], ".", 
     RowBox[{"\[FormalV]", "(", "q", ")"}]}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"cos", "(", "\[FormalTheta]", ")"}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[FormalK]", "\[Prime]",
      MultilineFunction->None], "(", "q", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", "\[Prime]",
         MultilineFunction->None], "(", "q", ")"}], ".", 
       RowBox[{"\[FormalV]", "(", "q", ")"}]}], "+", 
      RowBox[{
       RowBox[{"\[FormalK]", "(", "q", ")"}], ".", 
       RowBox[{
        SuperscriptBox["\[FormalV]", "\[Prime]",
         MultilineFunction->None], "(", "q", ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"cos", "(", "\[FormalTheta]", ")"}]}], ")"}], " ", 
    RowBox[{"\[FormalK]", "(", "q", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "q", ")"}], ".", 
       RowBox[{"\[FormalV]", "(", "q", ")"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[FormalK]", "\[Prime]",
          MultilineFunction->None], "(", "q", ")"}], ".", 
        RowBox[{
         SuperscriptBox["\[FormalV]", "\[Prime]",
          MultilineFunction->None], "(", "q", ")"}]}]}], "+", 
      RowBox[{
       RowBox[{"\[FormalK]", "(", "q", ")"}], ".", 
       RowBox[{
        SuperscriptBox["\[FormalV]", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "q", ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"sin", "(", "\[FormalTheta]", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "q", ")"}], "\[Cross]", 
       RowBox[{"\[FormalV]", "(", "q", ")"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[FormalK]", "\[Prime]",
          MultilineFunction->None], "(", "q", ")"}], "\[Cross]", 
        RowBox[{
         SuperscriptBox["\[FormalV]", "\[Prime]",
          MultilineFunction->None], "(", "q", ")"}]}]}], "+", 
      RowBox[{
       RowBox[{"\[FormalK]", "(", "q", ")"}], "\[Cross]", 
       RowBox[{
        SuperscriptBox["\[FormalV]", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "q", ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"cos", "(", "\[FormalTheta]", ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[FormalV]", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "q", ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.797036123979212*^9, 3.797036153346146*^9}, 
   3.797036200732106*^9, {3.7970362392353153`*^9, 3.797036247106689*^9}, {
   3.7970362774364643`*^9, 3.79703629263134*^9}},
 CellLabel->
  "Out[183]//TraditionalForm=",ExpressionUUID->"ef0031d5-c7a3-4cbc-ab55-\
31c471c1c6d9"]
}, Open  ]],

Cell["or in a mult-dimensional case", "Text",
 CellChangeTimes->{{3.797036204383214*^9, 3.797036208254756*^9}, {
  3.7970362996382713`*^9, 
  3.7970363085983*^9}},ExpressionUUID->"60884ccc-abbd-4286-8a7e-1cb4e6131174"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"rodRot", "[", 
     RowBox[{"q1", ",", " ", "q2"}], "]"}], ",", " ", "q1", ",", " ", "q2"}], 
   "]"}], "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.797036311598572*^9, 3.797036336677382*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"5e4c21cc-61ff-42f6-bc5a-031ac736f3df"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"cos", "(", "\[FormalTheta]", ")"}]}], ")"}], " ", 
    RowBox[{"\[FormalK]", "(", 
     RowBox[{"q1", ",", "q2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], ".", 
       RowBox[{
        SuperscriptBox["\[FormalV]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], ".", 
       RowBox[{
        SuperscriptBox["\[FormalV]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], ".", 
       RowBox[{"\[FormalV]", "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"\[FormalK]", "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], ".", 
       RowBox[{
        SuperscriptBox["\[FormalV]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"cos", "(", "\[FormalTheta]", ")"}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[FormalK]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "(", 
     RowBox[{"q1", ",", "q2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], ".", 
       RowBox[{"\[FormalV]", "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"\[FormalK]", "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], ".", 
       RowBox[{
        SuperscriptBox["\[FormalV]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"cos", "(", "\[FormalTheta]", ")"}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[FormalK]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "(", 
     RowBox[{"q1", ",", "q2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], ".", 
       RowBox[{"\[FormalV]", "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"\[FormalK]", "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], ".", 
       RowBox[{
        SuperscriptBox["\[FormalV]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"sin", "(", "\[FormalTheta]", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], "\[Cross]", 
       RowBox[{
        SuperscriptBox["\[FormalV]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], "\[Cross]", 
       RowBox[{
        SuperscriptBox["\[FormalV]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[FormalK]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], "\[Cross]", 
       RowBox[{"\[FormalV]", "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"\[FormalK]", "(", 
        RowBox[{"q1", ",", "q2"}], ")"}], "\[Cross]", 
       RowBox[{
        SuperscriptBox["\[FormalV]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "(", 
        RowBox[{"q1", ",", "q2"}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"cos", "(", "\[FormalTheta]", ")"}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[FormalK]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "(", 
     RowBox[{"q1", ",", "q2"}], ")"}], " ", 
    RowBox[{
     RowBox[{"\[FormalK]", "(", 
      RowBox[{"q1", ",", "q2"}], ")"}], ".", 
     RowBox[{"\[FormalV]", "(", 
      RowBox[{"q1", ",", "q2"}], ")"}]}]}], "+", 
   RowBox[{
    RowBox[{"cos", "(", "\[FormalTheta]", ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[FormalV]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "(", 
     RowBox[{"q1", ",", "q2"}], ")"}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.797036329966455*^9, 3.7970363370014467`*^9}},
 CellLabel->
  "Out[186]//TraditionalForm=",ExpressionUUID->"8982ce9f-d5c2-4ac4-9dc7-\
24669ca21d4f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{46, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->FrontEnd`FileName[{"UWTools"}, "ExplorationStyle.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 167, 3, 72, "Section",ExpressionUUID->"e8fed0b6-c7ef-4c9a-ad30-35bf40135a5c"],
Cell[750, 27, 535, 9, 87, "ExpositoryText",ExpressionUUID->"2d86bed5-1bc4-4815-8079-826bb9331c36"],
Cell[CellGroupData[{
Cell[1310, 40, 469, 13, 29, "Subitem",ExpressionUUID->"79e20878-28a6-4c5b-ad55-56cdfe4ad546"],
Cell[1782, 55, 981, 28, 29, "Subitem",ExpressionUUID->"eb90f171-295b-48a5-b375-952193c3bf48"],
Cell[2766, 85, 159, 3, 29, "Subitem",ExpressionUUID->"68ebe138-f294-45cc-bd38-c89365ddc2dd"]
}, Open  ]],
Cell[2940, 91, 197, 3, 37, "ExpositoryText",ExpressionUUID->"0738a1ea-ec14-4624-9fa0-d301ed8b3ead"],
Cell[CellGroupData[{
Cell[3162, 98, 775, 25, 29, "Subitem",ExpressionUUID->"a00a4682-e77d-498c-9272-74cc45470720"],
Cell[3940, 125, 849, 26, 31, "Subitem",ExpressionUUID->"d09e75bb-9717-4228-aedc-0e41c4714818"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4826, 156, 160, 3, 57, "Subsection",ExpressionUUID->"0c2a502a-41ee-4ae2-834b-c45f5d35f103"],
Cell[4989, 161, 220, 3, 37, "ExpositoryText",ExpressionUUID->"d69f69e3-8933-4aae-b3c5-ecca8fc7072d"],
Cell[5212, 166, 1710, 52, 74, "ExpositoryMathCentered",ExpressionUUID->"017310d1-4fdc-47de-ac79-12c730d6fd9c"],
Cell[6925, 220, 1104, 26, 40, "ExpositoryText",ExpressionUUID->"2839527e-f0ff-4282-b40b-cc25cb977383"],
Cell[8032, 248, 2049, 66, 86, "ExpositoryMathCentered",ExpressionUUID->"bb060644-da4c-414c-810c-216040d9b6e8"],
Cell[10084, 316, 168, 3, 37, "ExpositoryText",ExpressionUUID->"3918ad19-1b01-469d-9c0e-cc87182a698c"],
Cell[10255, 321, 1097, 33, 48, "ExpositoryMathCentered",ExpressionUUID->"85bb843b-1b5e-4099-9dcf-549d4e72bc53"],
Cell[11355, 356, 622, 17, 40, "ExpositoryText",ExpressionUUID->"adcf2ee1-ba31-4bf7-9f8d-27f6f8d2e95f"],
Cell[11980, 375, 283, 5, 37, "ExpositoryText",ExpressionUUID->"bfb1bf87-96f9-404b-b186-8f3735793ece"],
Cell[12266, 382, 606, 18, 34, "ExpositoryMathCentered",ExpressionUUID->"e832871c-7817-431b-83b2-59cf4a69ccb5"],
Cell[12875, 402, 175, 3, 37, "ExpositoryText",ExpressionUUID->"2ef5af10-748c-4bd3-9c6d-68a44195cc5e"],
Cell[13053, 407, 2072, 59, 92, "ExpositoryMathCentered",ExpressionUUID->"b2b75795-feb0-4548-87df-fc3698a059fc"],
Cell[15128, 468, 464, 11, 40, "ExpositoryText",ExpressionUUID->"ca39ba23-89ef-4a25-a48a-7a6c2ce35890"],
Cell[15595, 481, 1248, 39, 48, "ExpositoryMathCentered",ExpressionUUID->"5c24916b-8d48-4b0d-8bd2-211e9fa38c3e"],
Cell[16846, 522, 259, 5, 37, "ExpositoryText",ExpressionUUID->"5ee86288-b33c-49dc-a931-5183ae8e155f"],
Cell[17108, 529, 8176, 225, 214, "ExpositoryMathCentered",ExpressionUUID->"780ca64f-7412-4115-ac4e-3fabdc685536"],
Cell[25287, 756, 548, 13, 37, "ExpositoryText",ExpressionUUID->"e082c27d-1380-4fe6-9867-e6356a051271"],
Cell[25838, 771, 746, 22, 48, "ExpositoryMathCentered",ExpressionUUID->"bdcabde6-fad3-4c74-9a81-d35e09af030b"],
Cell[26587, 795, 441, 12, 37, "Text",ExpressionUUID->"1d0d88a4-8be6-4a3c-868e-3a6c7a256791"],
Cell[27031, 809, 836, 27, 48, "ExpositoryMathCentered",ExpressionUUID->"f2d8d398-826e-49db-9651-88b4628fcfff"],
Cell[27870, 838, 246, 6, 37, "ExpositoryText",ExpressionUUID->"289f73fd-c855-4e7f-9651-93d24e4e1cff"],
Cell[28119, 846, 1962, 60, 32, "ExpositoryMathCentered",ExpressionUUID->"f70abed5-56a6-4516-8668-c80459e4d4f6"],
Cell[30084, 908, 237, 4, 37, "ExpositoryText",ExpressionUUID->"e21ff5cc-9949-4e5a-a512-6883022f0124"],
Cell[30324, 914, 13268, 359, 492, "ExpositoryMathCentered",ExpressionUUID->"dc3db01e-6321-4fa7-b405-bab5d5889b1c"],
Cell[43595, 1275, 527, 13, 39, "ExpositoryText",ExpressionUUID->"ab325d18-0b9d-4cac-b66c-c5463dee3f2a"],
Cell[44125, 1290, 3015, 90, 92, "ExpositoryMathCentered",ExpressionUUID->"973f7311-0276-48d2-bcd8-55df61794737"],
Cell[47143, 1382, 317, 6, 37, "ExpositoryText",ExpressionUUID->"520e2d13-9ac0-40d3-9c68-ad1a6241de16"],
Cell[47463, 1390, 3376, 97, 90, "ExpositoryMathCentered",ExpressionUUID->"4d4d03e2-8d54-40ad-ab96-bc94178ddc4a"],
Cell[50842, 1489, 273, 6, 37, "ExpositoryText",ExpressionUUID->"8e291441-8d4c-4027-83c2-113d86d61d82"],
Cell[51118, 1497, 202, 3, 37, "ExpositoryText",ExpressionUUID->"8ae3412a-46ef-4025-a63f-9a286bc16ae2"],
Cell[CellGroupData[{
Cell[51345, 1504, 507, 14, 29, "Subitem",ExpressionUUID->"69ba4066-166a-4277-866a-3aabb3872767"],
Cell[51855, 1520, 949, 30, 31, "Subitem",ExpressionUUID->"2f33073c-3178-4180-9ca8-7061814dfdaa"],
Cell[52807, 1552, 872, 27, 31, "Subitem",ExpressionUUID->"da9c34ce-3d67-4114-b086-5fffee5d4038"]
}, Open  ]],
Cell[53694, 1582, 177, 3, 37, "ExpositoryText",ExpressionUUID->"8d40a7a5-2e7b-4dc0-a34a-3d612216a9d4"],
Cell[53874, 1587, 1412, 40, 92, "ExpositoryMathCentered",ExpressionUUID->"e0c4e874-d602-4bd3-851b-f1664b8f8636"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55323, 1632, 162, 3, 57, "Subsection",ExpressionUUID->"eb827615-2e3d-4727-9015-ebf6678e9253"],
Cell[55488, 1637, 1974, 60, 833, "ExpositoryMath",ExpressionUUID->"7141d0d4-0249-41fe-a05d-01f8d38bfcdc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57499, 1702, 165, 3, 57, "Subsection",ExpressionUUID->"2fa6de8d-58f8-417b-a789-48b885615aea"],
Cell[57667, 1707, 463, 9, 87, "ExpositoryText",ExpressionUUID->"37290334-3847-40c4-aa6c-ded8636afa84"],
Cell[58133, 1718, 710, 20, 32, "ExpositoryMathCentered",ExpressionUUID->"199c75d8-4ecc-4fbf-8ea2-9d9d12d0d2a7"],
Cell[58846, 1740, 244, 6, 37, "ExpositoryText",ExpressionUUID->"0ac1be16-10af-4ac4-8ba0-5e16742a632d"],
Cell[CellGroupData[{
Cell[59115, 1750, 1366, 38, 100, "Input",ExpressionUUID->"1d69062d-4b01-436b-9dec-3722b92110e1"],
Cell[60484, 1790, 1996, 55, 43, "Output",ExpressionUUID->"dea9f4bc-6832-4a96-b0d4-a24e3c83abe0"],
Cell[62483, 1847, 3313, 90, 61, "Output",ExpressionUUID->"ef0031d5-c7a3-4cbc-ab55-31c471c1c6d9"]
}, Open  ]],
Cell[65811, 1940, 218, 3, 37, "Text",ExpressionUUID->"60884ccc-abbd-4286-8a7e-1cb4e6131174"],
Cell[CellGroupData[{
Cell[66054, 1947, 359, 9, 30, "Input",ExpressionUUID->"5e4c21cc-61ff-42f6-bc5a-031ac736f3df"],
Cell[66416, 1958, 7069, 229, 151, "Output",ExpressionUUID->"8982ce9f-d5c2-4ac4-9dc7-24669ca21d4f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

